name = "zhe-edge"
main = "src/index.ts"
compatibility_date = "2025-01-01"

# ─── KV Namespace Binding ────────────────────────────────────────────────────
[[kv_namespaces]]
binding = "LINKS_KV"
id = "7d4702bf5657489cbc6a266e10db1aba"

# ─── Cron Triggers ───────────────────────────────────────────────────────────
# Runs every 15 minutes to sync D1 → KV for consistency
[triggers]
crons = ["*/15 * * * *"]

# ─── Environment Variables (set via `wrangler secret put`) ───────────────────
# ORIGIN_URL      — Railway backend URL (e.g. https://zhe.to or Railway internal)
# WORKER_SECRET   — shared secret for both /api/cron/sync-kv and /api/record-click
